\chapter{要素技術}
\label{elements}
\indent
本章では，本機構を構築するために必要であるIPネットワークを用いた映像・音声転送技術,
及びそれらの効率的に用いられる技術に関して述べる．

\section{IPネットワークにおける映像・音声配信技術}
\label{elements:tech}
\indent
本節ではIPネットワーク上における映像・音声配信に用いられる, ストリーミング技術に関して述べる. 

\subsection{ストリーミング}
\label{elements:tech:stream}
\indent
映像・音声データ全体を受信してからローカルで再生する方式が図 のダウンロード型再生方式である. 
これに対し, データの受信と再生を平行して行う方式が図 のストリーミング型再生方式である. 
youtubeなどに代表されるオンデマンド型映像・音声配信だけでなく, 
リアルタイム性の高い映像・音声配信にも用いられる. 
  
\begin{figure}[h]
\begin{center}
\includegraphics[width=350pt]{figure/Stream.eps}
\caption{ストリーミング概要}
\label{fig:stream}
\end{center}
\end{figure}


\section{通信技術}
\label{elements:efficient}
\indent
本節ではストリーミングを行う上で必要不可欠といえる通信技術に関して述べる. 


\subsection{IPマルチキャスト}
\label{elements:efficient:ipmcast}
\indent
単一の送信ノードが複数の受信ノードに対し, 
同一の内容のパケットを一斉に配信する場合に用いられるのがIPマルチキャスト技術である. 
送信ノードから同一の内容のパケットを複数の受信ノードに配信するには, 
ユニキャストを用いる方法とマルチキャストを用いる方法とがある. 

\indent
複数のユニキャスト(1対1)通信を用いた場合, 送信元のノードが配信するデータサイズは受信ノード数に比例する. 
このためデータの配信処理を行うための送信ノードの計算機資源の消費量が増加する. 
また, 送信ノードが必要とするネットワーク大域も同様に増加する.  

\indent 
IPマルチキャストの概要を図\ref{fig:mcast}に示す. 
マルチキャスト通信を用いた場合, 送信ノードは単一のパケットのみを配信する. 
パケットは, 途中の適切なルータによって複製され, 受信ノードに対して配信される. 
経路上のルータは, マルチキャスト受信ノードが異なるインターフェースに存在している場合のみ, 
パケットの複製を行う. 

\indent
IPネットワークにおいてマルチキャスト通信を行うIPマルチキャストは, 
送信ノードで受信ノード数のパケットを複製せずに, 分散しているルータを重用いてパケットの複製を行うので
負荷が分散される. 
しかし, IPマルチキャストを行うにはマルチキャスト経路制御とサポートするノードやスイッチ・ルータなどの
ネットワーク環境が必要である. 

\indent
マルチキャストパケットの配送は, マルチキャストアドレスに基づいたグループに参加している全てのノードに配送される. 
このため, IPマルチキャストの経路制御は複数のホストを対象として行わなくてはならないため非常に複雑となる. 
さらに, 送信ノードが直接受信ノードに配信を行っていないので, 受信ノードの状態を把握するのが難しい.
また, 現状ではコンテンツやネットワークの管理を考慮したアプリケーションがないため, 
同一ISP内のような一部の限定されたネットワークを除いてはIPマルチキャストの普及は難しい. 


\begin{figure}[h]
\begin{center}
\includegraphics[width=440pt]{figure/mcast.eps}
\caption{マルチキャスト概要}
\label{fig:mcast}
\end{center}
\end{figure}


 
\subsection{CDN}
\label{elements:efficient:cdn}
\indent
CDN (Contents Distribution Network) は一対多モデルの配信元を複数箇所に分散させることにより
配信元の負荷を軽減させ, 受信者に安定した映像を提供するための技術である. 
具体的には, 配信元に存在するコンテンツを各ISP に分散させたサーバに対してキャッシュし, 
受信者に最適なサーバを伝達することによって配信の効率化を行なう. 
しかし, 一般の配信者は, システムを構築するコストの問題からCDN を気軽に映像配信に利用することができない. 
また, 各ISP がCDN 網に参加していることを前堤としており, 受信者に対して映像配信を行なうことは困難である.


\section{アプリケーション}
\label{elements:applicatoin}
\indent

\subsection{DVTS}
\label{elements:application:dvts}
\indent
DVTSは市販のDVカメラをPCを用いて低コストで利用可能である. 
IEEE1394インターフェースからDVフォーマットのデータを取得し, 
次にIPデータグラム化を行い, インターネットを介してリアルタイム映像・音声伝送を行う. 
通信方式として, 輻輳制御・再送処理による意図しないスループットの低下, 
及び遅延増加を防ぐため, UDP\cite{rfc768}を用いる. また, 
パケット到達性が保障されていないUDPで到達順序を把握するためにRTP/RTCP\cite{rfc3550}を用いる. 
約30Mbpsの大域を必要とする. 

\indent
DVフォーマットはフレーム内圧縮方式であり, 
一部のデータの欠損が複数フレームにわたって連続的に影響を与えることはない. 
そのため, 映像フレームを間引くことで消費大域の調整をリアルタイムで行うことが可能である. 

\indent
DVフォーマット[4]のデータ構造を図1に示す.

\begin{figure}[h]
\begin{center}
\includegraphics[width=440pt]{figure/dv.eps}
\caption{ＤＶフォーマット}
\label{fig:dv}
\end{center}
\end{figure}

\indent
DVデータは10個のDIFシーケンスから成る.
DIFシーケンス内には"Header", "Subcode", "VAUX",  "Audio and Video"の4種のセクションが存在する.
これらのデータは80byteごとにDIFブロックの形に区切られIEEE1394インターフェース上に転送される.
また, DV フォーマットは，フレーム単位で抽象化されたフォーマットなので，
全てのデータ(映像，音声，システムデータ) はフレーム単位で扱われる．

